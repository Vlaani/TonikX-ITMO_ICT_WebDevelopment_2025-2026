{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"report_1/","title":"\u041e\u0442\u0447\u0451\u0442 \u043f\u043e \u043b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u0435 \u21161","text":"<p>\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u043b \u0410\u043d\u0438\u0441\u0438\u043c\u043e\u0432 \u0412\u043b\u0430\u0434\u0438\u0441\u043b\u0430\u0432 \u041a3340</p>"},{"location":"report_1/#1","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 1","text":"<p>\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0443\u044e \u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u0443\u044e \u0447\u0430\u0441\u0442\u044c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f. \u041a\u043b\u0438\u0435\u043d\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u00abHello, server\u00bb, \u0438 \u043e\u043d\u043e \u0434\u043e\u043b\u0436\u043d\u043e \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c\u0441\u044f \u043d\u0430 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u0412 \u043e\u0442\u0432\u0435\u0442 \u0441\u0435\u0440\u0432\u0435\u0440 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0443 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u00abHello, client\u00bb, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c\u0441\u044f \u0443 \u043a\u043b\u0438\u0435\u043d\u0442\u0430.</p> <p>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f:  - \u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 socket.  - \u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430 UDP.</p>"},{"location":"report_1/#_1","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0434\u0438\u043c \u0441\u043e\u043a\u0435\u0442 \u0434\u043b\u044f UDP \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u043c \u043e\u0442\u0432\u0435\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0443:  </p> <pre><code>def task_1():\n    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\n    sock.bind((\"\", port))\n    print(f'Server (udp) is listening at localhost:{port}')\n\n    while True:\n        data, client_address = sock.recvfrom(1024)\n        if not data:\n            break\n        print(f\"Recieved data (&lt;= 4 Kb): {data.decode('utf-8')}\")\n        sock.sendto(\"Hello, client!\".encode('utf-8'), client_address)\n    socket.close()\n</code></pre>"},{"location":"report_1/#2","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 2","text":"<p>\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0443\u044e \u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u0443\u044e \u0447\u0430\u0441\u0442\u044c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f. \u041a\u043b\u0438\u0435\u043d\u0442 \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438, \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0432\u0432\u043e\u0434\u044f\u0442\u0441\u044f \u0441 \u043a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u044b. \u0421\u0435\u0440\u0432\u0435\u0440 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0443.</p> <p>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f:  - \u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 socket.  - \u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430 TCP.</p>"},{"location":"report_1/#_2","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0434\u0438\u043c \u0441\u043e\u043a\u0435\u0442 \u0434\u043b\u044f TCP \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f. \u0414\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u0441\u043b\u0430\u043d\u044b\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u043c \u0440\u0430\u0441\u043f\u0430\u0440\u0441\u0438\u043c \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e json. \u0417\u0430\u0442\u0435\u043c \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u043c \u043e\u0442\u0432\u0435\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0443:  </p> <pre><code>def task_2():\n    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    sock.bind((\"\", port))\n    sock.listen(max_clients)\n    print(f'Server (tcp) is listening at localhost:{port}')\n\n    while True:\n        conn, client_address = sock.accept()\n        data = conn.recv(max_data_size)\n        if not data:\n            print(\"Connection close\")\n            conn.close()\n            break\n        print(f\"Recieved data (&lt;= {max_data_size / 1024.0} Kb) from {client_address}: {data.decode('utf-8')}\")\n        conn.send(bytes(str(solve_problem(data, client_address)).encode('utf-8')))\n    socket.close()\n</code></pre> <pre><code>if problem[\"op\"] == 1:\n        return math.sqrt(problem[\"a\"]**2 + problem[\"b\"]**2)\n    elif problem[\"op\"] == 2:\n        if problem[\"a\"] == 0:\n            if problem[\"b\"] == 0:\n                if problem[\"c\"] == 0:\n                    return \"Infinite solutions (0=0)\"\n                else:\n                    return \"No solution (c!=0)\"\n            else:\n                # Linear equation bx + c = 0\n                return -problem[\"c\"] / problem[\"b\"]\n        discriminant = (problem[\"b\"]**2) - (4 * problem[\"a\"] * problem[\"c\"])\n        if discriminant &gt; 0:\n            root1 = (-problem[\"b\"] - cmath.sqrt(discriminant)) / (2 * problem[\"a\"])\n            root2 = (-problem[\"b\"] + cmath.sqrt(discriminant)) / (2 * problem[\"a\"])\n            return root1, root2\n        elif discriminant == 0:\n            root = -problem[\"b\"] / (2 * problem[\"a\"])\n            return root\n        else:  # discriminant &lt; 0\n            root1 = (-problem[\"b\"] - cmath.sqrt(discriminant)) / (2 * problem[\"a\"])\n            root2 = (-problem[\"b\"] + cmath.sqrt(discriminant)) / (2 * problem[\"a\"])\n            return root1, root2\n    elif problem[\"op\"] == 3:\n        return (problem[\"base1\"] + problem[\"base2\"]) / 2 * problem[\"height\"]\n    elif problem[\"op\"] == 4:\n        return problem[\"base\"] * problem[\"height\"]\n\n    return \"idk...\"\n</code></pre>"},{"location":"report_1/#3","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 3","text":"<p>\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u0443\u044e \u0447\u0430\u0441\u0442\u044c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f. \u041a\u043b\u0438\u0435\u043d\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443, \u0438 \u0432 \u043e\u0442\u0432\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 HTTP-\u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435, \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0435\u0435 HTML-\u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u0441\u0435\u0440\u0432\u0435\u0440 \u043f\u043e\u0434\u0433\u0440\u0443\u0436\u0430\u0435\u0442 \u0438\u0437 \u0444\u0430\u0439\u043b\u0430 index.html.</p> <p>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f:  - \u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 socket.</p>"},{"location":"report_1/#_3","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435","text":"<p>\u0412 \u044d\u0442\u043e\u043c \u0437\u0430\u0434\u0430\u043d\u0438\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0441\u0435\u0440\u0432\u0435\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u044b\u043b \u043d\u0430\u043f\u0438\u0441\u0430\u043d \u0432 \u0437\u0430\u0434\u0430\u043d\u0438\u044f\u0445 3-5. \u0417\u0434\u0435\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0451\u0442\u0441\u044f TCP \u0441\u0435\u0440\u0432\u0435\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0440\u043e\u0441\u0442\u043e \u043e\u0442\u0441\u044b\u043b\u0430\u0435\u0442 \u0441\u0442\u0440\u0430\u043d\u0438\u0447\u043a\u0443 \u0432 \u043e\u0442\u0432\u0435\u0442.</p> <pre><code>async def task_3():\n    server = Server()\n    server.add_route(method_type.GET, \"/\", send_html_page)\n    await server.serve_forever(\"\", port, connection_type.TCP)\n</code></pre> <pre><code>def send_html_page(request):\n    file = open(\"index.html\", \"r\").read()\n    return (200, file)\n</code></pre>"},{"location":"report_1/#4","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 4","text":"<p>\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u0432\u0443\u0445\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u0438\u043b\u0438 \u043c\u043d\u043e\u0433\u043e\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u0447\u0430\u0442. \u0414\u043b\u044f \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0431\u0430\u043b\u043b\u043e\u0432 \u0440\u0435\u0430\u043b\u0438\u0437\u0443\u0439\u0442\u0435 \u043c\u043d\u043e\u0433\u043e\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u0447\u0430\u0442.</p> <p>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f:  - \u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 socket.  - \u0414\u043b\u044f \u043c\u043d\u043e\u0433\u043e\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0433\u043e \u0447\u0430\u0442\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 threading.</p>"},{"location":"report_1/#_4","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435","text":"<p>\u0412 \u044d\u0442\u043e\u043c \u0437\u0430\u0434\u0430\u043d\u0438\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0441\u0435\u0440\u0432\u0435\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u044b\u043b \u043d\u0430\u043f\u0438\u0441\u0430\u043d \u0432 \u0437\u0430\u0434\u0430\u043d\u0438\u044f\u0445 3-5. \u0417\u0434\u0435\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0451\u0442\u0441\u044f TCP \u0441\u0435\u0440\u0432\u0435\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0432 \u043c\u043d\u043e\u0433\u043e\u043f\u043e\u0442\u043e\u0447\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435. \u041a\u043e\u0434 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0432 \u0444\u0430\u0439\u043b\u0435 \u043b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u043e\u0439. </p> <pre><code>async def task_4():\n    server = Server()\n    server.add_route(method_type.POST, \"/join\", join_route)\n    server.add_route(method_type.POST, \"/send\", send_route)\n    server.add_route(method_type.GET, \"/login\", login_route)\n    server.add_route(method_type.GET, \"/messages\", messages_route)\n    server.add_route(method_type.GET, \"/\", default_route)\n    server.add_route(method_type.GET, \"/chat.html\", default_route)\n    await server.serve_forever(\"\", port, connection_type.TCP)\n</code></pre> <pre><code>chats = {}\nusers = {}\nlock = threading.Lock()\n\ndef join_route(request):\n    args = request[\"json\"]\n    userName = args[\"userName\"]\n    user = users[userName]\n    chat_id = args[\"chat_id\"]\n    if chat_id not in chats:\n        chats[chat_id] = Chat(set(), list())\n    chats[chat_id].users.add(user)\n    user.chats.add(chat_id)\n    user.update_event.set()\n    user.new_messages[chat_id] = [] if len(chats[chat_id].messages) == 0 else [len(chats[chat_id].messages)-1]\n    return (200, f\"You successfully joined chat \\\"{chat_id}\\\"\")\n\ndef send_route(request):\n    global lock\n    args = request[\"json\"]\n    userName = args[\"userName\"]\n    user = users[userName]\n    chat_id = args[\"chat_id\"]\n    i = 0\n    with lock:\n        chats[chat_id].messages.append(Message(user.name, args[\"text\"], time.time()))\n        i = len(chats[chat_id].messages) - 1\n    for u in chats[chat_id].users:\n        if chat_id not in u.new_messages: \n            u.new_messages[chat_id] = []\n        u.new_messages[chat_id].append(i)\n        u.update_event.set()\n    r = args[\"text\"]\n    return (200, f\"You successfully sended a message in chat \\\"{chat_id}\\\"\")\n\ndef login_route(request):\n    args = request[\"args\"]\n    if \"userName\" not in args:\n        return (422, \"\")\n    userName = unquote(args[\"userName\"])\n    if userName not in users:\n        user = User(userName)\n        users[userName] = user\n    return (200, json.dumps(\"You successfully logged in\"))\n\ndef messages_route(request):\n    args = request[\"args\"]\n    result = []\n\n    if \"userName\" not in args:\n        return (422, \"\")\n    userName = unquote(args[\"userName\"])\n    if userName not in users:\n        return (401, \"Not logged in\")\n    else:\n        user = users[userName]\n\n    if \"chat_id\" not in args:\n        if \"loadAllLast\" not in args or args[\"loadAllLast\"] == \"false\":\n            if not user.update_event.is_set():\n                user.update_event.wait(timeout=30)\n                if not user.update_event.is_set():\n                    return (200, json.dumps(\"no updates\"))\n            user.update_event.clear()\n            for id, messages_ids in user.new_messages.items():\n                m_count = len(chats[id].messages)\n                if m_count != 0:\n                    messages = list(map(lambda x: chats[id].messages[x], messages_ids))\n                    result.append((id, messages, str(m_count - len(messages_ids)) + \":\" + str(m_count)))\n                else:\n                    result.append((id, [], \"0:0\"))\n            user.new_messages.clear()\n        else:\n            user.update_event.clear()\n            user.new_messages.clear()\n            for index in user.chats:\n                m_count = len(chats[index].messages)\n                if m_count != 0:\n                    result.append((index, [chats[index].messages[-1]], str(m_count - 1) + \":\" + str(m_count)))\n                else:\n                    result.append((index, [], \"0:0\"))\n\n        return (200, json.dumps(result))\n\n    cur_chat = unquote(args[\"chat_id\"])\n    start = args[\"range\"].split(':')[0]\n    end = None\n    if (len(args[\"range\"].split(':')) == 2):\n        end = args[\"range\"].split(':')[1]\n    m = chats[cur_chat].messages\n    return (200, json.dumps([(cur_chat, m[int(start):int(end)], args[\"range\"])]))\n\ndef default_route(request):\n    file = open(\"./chat.html\", \"r\").read()\n    return (200, file)\n</code></pre>"},{"location":"report_1/#5","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 5","text":"<p>\u041d\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u043f\u0440\u043e\u0441\u0442\u043e\u0439 \u0432\u0435\u0431-\u0441\u0435\u0440\u0432\u0435\u0440 \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 GET \u0438 POST HTTP-\u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 socket \u0432 Python.</p>"},{"location":"report_1/#_5","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435","text":"<p>\u0412 \u044d\u0442\u043e\u043c \u0437\u0430\u0434\u0430\u043d\u0438\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0441\u0435\u0440\u0432\u0435\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u044b\u043b \u043d\u0430\u043f\u0438\u0441\u0430\u043d \u0432 \u0437\u0430\u0434\u0430\u043d\u0438\u044f\u0445 3-5. \u0417\u0434\u0435\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0451\u0442\u0441\u044f TCP \u0441\u0435\u0440\u0432\u0435\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043d\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0446\u0435\u043d\u043e\u043a \u0438 \u0432\u044b\u0434\u0430\u0451\u0442 \u0441\u043f\u0438\u0441\u043a\u0438 \u043e\u0446\u0435\u043d\u043e\u043a \u043f\u043e \u0434\u0438\u0441\u0446\u0438\u043f\u043b\u0438\u043d\u0430\u043c. \u041a\u043e\u0434 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0432 \u0444\u0430\u0439\u043b\u0435 \u043b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u043e\u0439. </p> <pre><code>async def task_5():\n    server = Server()\n    server.add_route(method_type.POST, \"/add\", add_route)\n    server.add_route(method_type.GET, \"/get\", get_route)\n    server.add_route(method_type.GET, \"/\", get_table_route)\n    server.add_route(method_type.GET, \"/chat.html\", get_table_route)\n    await server.serve_forever(\"\", port, connection_type.TCP)\n</code></pre> <pre><code>grades = {}\n\ndef add_route(request):\n    args = request[\"json\"]\n    global grades\n    subject = args[\"subject\"]\n    if subject not in grades:\n        grades[subject] = []\n    grades[subject].append(int(args[\"grade\"]))\n    return (200, \"Successfully added\")\n\ndef get_route(request):\n    global grades\n    return (200, json.dumps(grades))\n\ndef get_table_route(request):\n    file = open(\"./table.html\", \"r\").read()\n    return (200, file)\n</code></pre> <p>\u041d\u0438\u0436\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d \u043a\u043e\u0434 \u0441\u0435\u0440\u0432\u0435\u0440\u0430.</p> <pre><code>import socket\nimport json\nimport threading\nimport asyncio\nimport sys\nfrom enum import Enum\n\nclass connection_type(Enum):\n    UDP = 1\n    TCP = 2\n\nclass method_type(Enum):\n    GET = 1\n    POST = 2\n    PUT = 3\n\nport = 9090\nmax_clients = 10\nmax_data_size = 4 * 1024\n\nclass Server:\n    clients = {}\n    routes = {\"GET\" : {},\n              \"PUT\" : {},\n              \"POST\" : {}}\n\n    async def serve_forever(self, host : str, port : int, conn_type : connection_type):\n        try:\n            self.conn_type = conn_type\n            if conn_type == connection_type.UDP:\n                self.sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\n                self.sock.bind((host, port))\n                print(f'Server (UDP) is listening at port {port}')\n            elif conn_type == connection_type.TCP:\n                self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n                self.sock.bind((host, port))\n                self.sock.listen(max_clients)\n                print(f'Server (TCP) is listening at port {port}')\n            if sys.platform == \"win32\" and sys.version_info &gt;= (3, 8, 0):\n                asyncio.set_event_loop_policy(asyncio.WindowsSelectorEventLoopPolicy())\n            await self.serve_clients()\n        except Exception:\n            print(Exception)\n        return self\n\n    async def serve_clients(self):\n        while True:\n            if self.conn_type == connection_type.UDP:\n                while True:\n                    data, client_address = self.sock.recvfrom(max_data_size)\n                    if not data:\n                        break\n                    await self.handle_request(data, client_address)\n            elif self.conn_type == connection_type.TCP:\n                conn, client_address = self.sock.accept()\n                self.clients[client_address] = conn\n                print(f\"New connection {conn}\")\n                threading.Thread(target=asyncio.run, args=(self.handle_request(conn, client_address),)).start()\n\n    async def handle_request(self, conn, client_address):\n        if self.conn_type == connection_type.UDP:\n            code, message = self.parse_request(conn, client_address)\n            self.sock.sendto(bytes(str(self.create_response(code, message)).encode('utf-8')), client_address)\n        elif self.conn_type == connection_type.TCP:\n            while True:\n                data = conn.recv(max_data_size)\n                if not data:\n                    print(\"Connection close\")\n                    conn.close()\n                    break\n                code, message = self.parse_request(data, client_address)\n                conn.send(bytes(str(self.create_response(code, message)).encode('utf-8')))\n\n    def parse_request(self, data, client_address):\n        out = {}\n        out[\"client_address\"] = client_address\n        _data = data.decode('utf-8')\n        lines = _data.split('\\r\\n')\n        print(f\"Recieved data (&lt;= {max_data_size / 1024.0} Kb) from {client_address}: {data.decode('utf-8')}\")\n        if len(_data) == 0:\n            return \"\"\n        method, path, _ = lines[0].split(' ')\n        method = method.strip()\n        args = \"\"\n        if '?' in path:\n            path, args = path.strip().split('?')\n        out[\"path\"] = path\n\n        if method == 'POST':\n            out[\"method\"] = method_type.POST\n            body = str(lines[-1]).strip()\n            out[\"body\"] = body\n            if body.startswith(\"{\"):\n                out[\"json\"] = json.loads(body)\n        elif method == 'GET':\n            out[\"method\"] = method_type.GET\n            if args:\n                args_dict = {}\n                for arg in args.split(\"&amp;\"):\n                    key, val = arg.split(\"=\")\n                    args_dict[key] = val\n                out[\"args\"] = args_dict\n\n        if out[\"method\"] not in self.routes or out[\"path\"] not in self.routes[out[\"method\"]]:\n            return (404, \"Resource not found\")\n\n        return self.routes[out[\"method\"]][out[\"path\"]](out)\n\n    def create_response(self, code, body):\n        length = len(body.encode('utf-8'))\n        return f\"HTTP/1.1 {code} OK\\nContent-Type: application/json,text/html; charset=utf-8\\nConnection: keep-alive\\nAccess-Control-Allow-Origin: *\\nContent-Length: {length}\\n\\n\" + body\n\n    def add_route(self, method : method_type, route : str, handler):\n        if method not in self.routes:\n            self.routes[method] = {}\n        self.routes[method][route] = handler\n</code></pre>"}]}