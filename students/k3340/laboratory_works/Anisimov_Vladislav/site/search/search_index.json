{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c!","text":"<p>\u042d\u0442\u043e \u0433\u043b\u0430\u0432\u043d\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u0441\u0430\u0439\u0442\u0430 \u0441 \u043b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u044b\u043c\u0438 \u0440\u0430\u0431\u043e\u0442\u0430\u043c\u0438 \u043f\u043e \u0432\u0435\u0431-\u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435.</p>"},{"location":"report_1/","title":"\u041e\u0442\u0447\u0451\u0442 \u043f\u043e \u043b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u0435 \u21161","text":"<p>\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u043b \u0410\u043d\u0438\u0441\u0438\u043c\u043e\u0432 \u0412\u043b\u0430\u0434\u0438\u0441\u043b\u0430\u0432 \u041a3340</p>"},{"location":"report_1/#1","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 1","text":"<p>\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0443\u044e \u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u0443\u044e \u0447\u0430\u0441\u0442\u044c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f. \u041a\u043b\u0438\u0435\u043d\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u0441\u0435\u0440\u0432\u0435\u0440\u0443 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u00abHello, server\u00bb, \u0438 \u043e\u043d\u043e \u0434\u043e\u043b\u0436\u043d\u043e \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c\u0441\u044f \u043d\u0430 \u0441\u0442\u043e\u0440\u043e\u043d\u0435 \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u0412 \u043e\u0442\u0432\u0435\u0442 \u0441\u0435\u0440\u0432\u0435\u0440 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0443 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u00abHello, client\u00bb, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c\u0441\u044f \u0443 \u043a\u043b\u0438\u0435\u043d\u0442\u0430.</p> <p>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f:  - \u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 socket.  - \u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430 UDP.</p>"},{"location":"report_1/#_1","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0434\u0438\u043c \u0441\u043e\u043a\u0435\u0442 \u0434\u043b\u044f UDP \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u043c \u043e\u0442\u0432\u0435\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0443:  </p> <pre><code>def task_1():\n    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\n    sock.bind((\"\", port))\n    print(f'Server (udp) is listening at localhost:{port}')\n\n    while True:\n        data, client_address = sock.recvfrom(1024)\n        if not data:\n            break\n        print(f\"Recieved data (&lt;= 4 Kb): {data.decode('utf-8')}\")\n        sock.sendto(\"Hello, client!\".encode('utf-8'), client_address)\n    socket.close()\n</code></pre>"},{"location":"report_1/#2","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 2","text":"<p>\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0443\u044e \u0438 \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u0443\u044e \u0447\u0430\u0441\u0442\u044c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f. \u041a\u043b\u0438\u0435\u043d\u0442 \u0437\u0430\u043f\u0440\u0430\u0448\u0438\u0432\u0430\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438, \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0432\u0432\u043e\u0434\u044f\u0442\u0441\u044f \u0441 \u043a\u043b\u0430\u0432\u0438\u0430\u0442\u0443\u0440\u044b. \u0421\u0435\u0440\u0432\u0435\u0440 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0435 \u0438 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0443.</p> <p>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f:  - \u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 socket.  - \u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430 TCP.</p>"},{"location":"report_1/#_2","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0434\u0438\u043c \u0441\u043e\u043a\u0435\u0442 \u0434\u043b\u044f TCP \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f. \u0414\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u0441\u043b\u0430\u043d\u044b\u0435 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u043c \u0440\u0430\u0441\u043f\u0430\u0440\u0441\u0438\u043c \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e json. \u0417\u0430\u0442\u0435\u043c \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u043c \u043e\u0442\u0432\u0435\u0442 \u043a\u043b\u0438\u0435\u043d\u0442\u0443:  </p> <pre><code>def task_2():\n    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    sock.bind((\"\", port))\n    sock.listen(max_clients)\n    print(f'Server (tcp) is listening at localhost:{port}')\n\n    while True:\n        conn, client_address = sock.accept()\n        data = conn.recv(max_data_size)\n        if not data:\n            print(\"Connection close\")\n            conn.close()\n            break\n        print(f\"Recieved data (&lt;= {max_data_size / 1024.0} Kb) from {client_address}: {data.decode('utf-8')}\")\n        conn.send(bytes(str(solve_problem(data, client_address)).encode('utf-8')))\n    socket.close()\n</code></pre> <pre><code>if problem[\"op\"] == 1:\n        return math.sqrt(problem[\"a\"]**2 + problem[\"b\"]**2)\n    elif problem[\"op\"] == 2:\n        if problem[\"a\"] == 0:\n            if problem[\"b\"] == 0:\n                if problem[\"c\"] == 0:\n                    return \"Infinite solutions (0=0)\"\n                else:\n                    return \"No solution (c!=0)\"\n            else:\n                # Linear equation bx + c = 0\n                return -problem[\"c\"] / problem[\"b\"]\n        discriminant = (problem[\"b\"]**2) - (4 * problem[\"a\"] * problem[\"c\"])\n        if discriminant &gt; 0:\n            root1 = (-problem[\"b\"] - cmath.sqrt(discriminant)) / (2 * problem[\"a\"])\n            root2 = (-problem[\"b\"] + cmath.sqrt(discriminant)) / (2 * problem[\"a\"])\n            return root1, root2\n        elif discriminant == 0:\n            root = -problem[\"b\"] / (2 * problem[\"a\"])\n            return root\n        else:  # discriminant &lt; 0\n            root1 = (-problem[\"b\"] - cmath.sqrt(discriminant)) / (2 * problem[\"a\"])\n            root2 = (-problem[\"b\"] + cmath.sqrt(discriminant)) / (2 * problem[\"a\"])\n            return root1, root2\n    elif problem[\"op\"] == 3:\n        return (problem[\"base1\"] + problem[\"base2\"]) / 2 * problem[\"height\"]\n    elif problem[\"op\"] == 4:\n        return problem[\"base\"] * problem[\"height\"]\n\n    return \"idk...\"\n</code></pre>"},{"location":"report_1/#3","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 3","text":"<p>\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u0435\u0440\u0432\u0435\u0440\u043d\u0443\u044e \u0447\u0430\u0441\u0442\u044c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f. \u041a\u043b\u0438\u0435\u043d\u0442 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443, \u0438 \u0432 \u043e\u0442\u0432\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 HTTP-\u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435, \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0435\u0435 HTML-\u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u0441\u0435\u0440\u0432\u0435\u0440 \u043f\u043e\u0434\u0433\u0440\u0443\u0436\u0430\u0435\u0442 \u0438\u0437 \u0444\u0430\u0439\u043b\u0430 index.html.</p> <p>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f:  - \u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 socket.</p>"},{"location":"report_1/#_3","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435","text":"<p>\u0412 \u044d\u0442\u043e\u043c \u0437\u0430\u0434\u0430\u043d\u0438\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0441\u0435\u0440\u0432\u0435\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u044b\u043b \u043d\u0430\u043f\u0438\u0441\u0430\u043d \u0432 \u0437\u0430\u0434\u0430\u043d\u0438\u044f\u0445 3-5. \u0417\u0434\u0435\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0451\u0442\u0441\u044f TCP \u0441\u0435\u0440\u0432\u0435\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0440\u043e\u0441\u0442\u043e \u043e\u0442\u0441\u044b\u043b\u0430\u0435\u0442 \u0441\u0442\u0440\u0430\u043d\u0438\u0447\u043a\u0443 \u0432 \u043e\u0442\u0432\u0435\u0442.</p> <pre><code>def task_3():\n    server = Server()\n    server.add_route(method_type.GET, \"/\", send_html_page)\n    server.serve_forever(\"\", port, connection_type.TCP)\n</code></pre> <pre><code>def send_html_page(request):\n    file = open(\"index.html\", \"r\").read()\n    return (200, file)\n</code></pre>"},{"location":"report_1/#4","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 4","text":"<p>\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0434\u0432\u0443\u0445\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u0438\u043b\u0438 \u043c\u043d\u043e\u0433\u043e\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u0447\u0430\u0442. \u0414\u043b\u044f \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0431\u0430\u043b\u043b\u043e\u0432 \u0440\u0435\u0430\u043b\u0438\u0437\u0443\u0439\u0442\u0435 \u043c\u043d\u043e\u0433\u043e\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u0439 \u0447\u0430\u0442.</p> <p>\u0422\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f:  - \u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 socket.  - \u0414\u043b\u044f \u043c\u043d\u043e\u0433\u043e\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0433\u043e \u0447\u0430\u0442\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443 threading.</p>"},{"location":"report_1/#_4","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435","text":"<p>\u0412 \u044d\u0442\u043e\u043c \u0437\u0430\u0434\u0430\u043d\u0438\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0441\u0435\u0440\u0432\u0435\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u044b\u043b \u043d\u0430\u043f\u0438\u0441\u0430\u043d \u0432 \u0437\u0430\u0434\u0430\u043d\u0438\u044f\u0445 3-5. \u0417\u0434\u0435\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0451\u0442\u0441\u044f TCP \u0441\u0435\u0440\u0432\u0435\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0432 \u043c\u043d\u043e\u0433\u043e\u043f\u043e\u0442\u043e\u0447\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435. \u041a\u043e\u0434 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0432 \u0444\u0430\u0439\u043b\u0435 \u043b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u043e\u0439. </p> <pre><code>def task_4():\n    server = Server()\n    server.add_route(method_type.POST, \"/join\", join_route)\n    server.add_route(method_type.POST, \"/send\", send_route)\n    server.add_route(method_type.GET, \"/login\", login_route)\n    server.add_route(method_type.GET, \"/messages\", messages_route)\n    server.add_route(method_type.GET, \"/\", default_route)\n    server.add_route(method_type.GET, \"/chat.html\", default_route)\n    server.serve_forever(\"\", port, connection_type.TCP)\n</code></pre> <pre><code>chats = {}\nusers = {}\nlock = threading.Lock()\n\ndef join_route(request):\n    args = request[\"json\"]\n    userName = args[\"userName\"]\n    user = users[userName]\n    chat_id = args[\"chat_id\"]\n    if chat_id not in chats:\n        chats[chat_id] = Chat(set(), list())\n    chats[chat_id].users.add(user)\n    user.chats.add(chat_id)\n    user.update_event.set()\n    user.new_messages[chat_id] = [] if len(chats[chat_id].messages) == 0 else [len(chats[chat_id].messages)-1]\n    return (200, f\"You successfully joined chat \\\"{chat_id}\\\"\")\n\ndef send_route(request):\n    global lock\n    args = request[\"json\"]\n    userName = args[\"userName\"]\n    user = users[userName]\n    chat_id = args[\"chat_id\"]\n    i = 0\n    with lock:\n        chats[chat_id].messages.append(Message(user.name, args[\"text\"], time.time()))\n        i = len(chats[chat_id].messages) - 1\n    for u in chats[chat_id].users:\n        if chat_id not in u.new_messages: \n            u.new_messages[chat_id] = []\n        u.new_messages[chat_id].append(i)\n        u.update_event.set()\n    r = args[\"text\"]\n    return (200, f\"You successfully sended a message in chat \\\"{chat_id}\\\"\")\n\ndef login_route(request):\n    args = request[\"args\"]\n    if \"userName\" not in args:\n        return (422, \"\")\n    userName = unquote(args[\"userName\"])\n    if userName not in users:\n        user = User(userName)\n        users[userName] = user\n    return (200, json.dumps(\"You successfully logged in\"))\n\ndef messages_route(request):\n    args = request[\"args\"]\n    result = []\n\n    if \"userName\" not in args:\n        return (422, \"\")\n    userName = unquote(args[\"userName\"])\n    if userName not in users:\n        return (401, \"Not logged in\")\n    else:\n        user = users[userName]\n\n    if \"chat_id\" not in args:\n        if \"loadAllLast\" not in args or args[\"loadAllLast\"] == \"false\":\n            if not user.update_event.is_set():\n                user.update_event.wait(timeout=30)\n                if not user.update_event.is_set():\n                    return (200, json.dumps(\"no updates\"))\n            user.update_event.clear()\n            for id, messages_ids in user.new_messages.items():\n                m_count = len(chats[id].messages)\n                if m_count != 0:\n                    messages = list(map(lambda x: chats[id].messages[x], messages_ids))\n                    result.append((id, messages, str(m_count - len(messages_ids)) + \":\" + str(m_count)))\n                else:\n                    result.append((id, [], \"0:0\"))\n            user.new_messages.clear()\n        else:\n            user.update_event.clear()\n            user.new_messages.clear()\n            for index in user.chats:\n                m_count = len(chats[index].messages)\n                if m_count != 0:\n                    result.append((index, [chats[index].messages[-1]], str(m_count - 1) + \":\" + str(m_count)))\n                else:\n                    result.append((index, [], \"0:0\"))\n\n        return (200, json.dumps(result))\n\n    cur_chat = unquote(args[\"chat_id\"])\n    start = args[\"range\"].split(':')[0]\n    end = None\n    if (len(args[\"range\"].split(':')) == 2):\n        end = args[\"range\"].split(':')[1]\n    m = chats[cur_chat].messages\n    return (200, json.dumps([(cur_chat, m[int(start):int(end)], args[\"range\"])]))\n\ndef default_route(request):\n    file = open(\"./chat.html\", \"r\").read()\n    return (200, file)\n</code></pre>"},{"location":"report_1/#5","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 5","text":"<p>\u041d\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u043f\u0440\u043e\u0441\u0442\u043e\u0439 \u0432\u0435\u0431-\u0441\u0435\u0440\u0432\u0435\u0440 \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 GET \u0438 POST HTTP-\u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 socket \u0432 Python.</p>"},{"location":"report_1/#_5","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435","text":"<p>\u0412 \u044d\u0442\u043e\u043c \u0437\u0430\u0434\u0430\u043d\u0438\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0441\u0435\u0440\u0432\u0435\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u044b\u043b \u043d\u0430\u043f\u0438\u0441\u0430\u043d \u0432 \u0437\u0430\u0434\u0430\u043d\u0438\u044f\u0445 3-5. \u0417\u0434\u0435\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0451\u0442\u0441\u044f TCP \u0441\u0435\u0440\u0432\u0435\u0440, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043d\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0446\u0435\u043d\u043e\u043a \u0438 \u0432\u044b\u0434\u0430\u0451\u0442 \u0441\u043f\u0438\u0441\u043a\u0438 \u043e\u0446\u0435\u043d\u043e\u043a \u043f\u043e \u0434\u0438\u0441\u0446\u0438\u043f\u043b\u0438\u043d\u0430\u043c. \u041a\u043e\u0434 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0432 \u0444\u0430\u0439\u043b\u0435 \u043b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u043e\u0439. </p> <pre><code>def task_5():\n    server = Server()\n    server.add_route(method_type.POST, \"/add\", add_route)\n    server.add_route(method_type.GET, \"/get\", get_route)\n    server.add_route(method_type.GET, \"/\", get_table_route)\n    server.add_route(method_type.GET, \"/chat.html\", get_table_route)\n    server.serve_forever(\"\", port, connection_type.TCP)\n</code></pre> <pre><code>grades = {}\n\ndef add_route(request):\n    args = request[\"json\"]\n    global grades\n    subject = args[\"subject\"]\n    if subject not in grades:\n        grades[subject] = []\n    grades[subject].append(int(args[\"grade\"]))\n    return (200, \"Successfully added\")\n\ndef get_route(request):\n    global grades\n    return (200, json.dumps(grades))\n\ndef get_table_route(request):\n    file = open(\"./table.html\", \"r\").read()\n    return (200, file)\n</code></pre> <p>\u041d\u0438\u0436\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d \u043a\u043e\u0434 \u0441\u0435\u0440\u0432\u0435\u0440\u0430.</p> <pre><code>import socket\nimport json\nimport threading\nfrom enum import Enum\n\nclass connection_type(Enum):\n    UDP = 1\n    TCP = 2\n\nclass method_type(Enum):\n    GET = 1\n    POST = 2\n    PUT = 3\n\nport = 9090\nmax_clients = 10\nmax_data_size = 4 * 1024\n\nclass Server:\n    clients = {}\n    routes = {\"GET\" : {},\n              \"PUT\" : {},\n              \"POST\" : {}}\n\n    def serve_forever(self, host : str, port : int, conn_type : connection_type):\n        try:\n            self.conn_type = conn_type\n            if conn_type == connection_type.UDP:\n                self.sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\n                self.sock.bind((host, port))\n                print(f'Server (UDP) is listening at port {port}')\n            elif conn_type == connection_type.TCP:\n                self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n                self.sock.bind((host, port))\n                self.sock.listen(max_clients)\n                print(f'Server (TCP) is listening at port {port}')\n            self.serve_clients()\n        except Exception:\n            print(Exception)\n        return self\n\n    def serve_clients(self):\n        while True:\n            if self.conn_type == connection_type.UDP:\n                while True:\n                    data, client_address = self.sock.recvfrom(max_data_size)\n                    if not data:\n                        break\n                    threading.Thread(target=self.handle_request, args=(data, client_address,)).start()\n            elif self.conn_type == connection_type.TCP:\n                conn, client_address = self.sock.accept()\n                self.clients[client_address] = conn\n                print(f\"New connection {conn}\")\n                threading.Thread(target=self.handle_request, args=(conn, client_address,)).start()\n\n    def handle_request(self, conn, client_address):\n        if self.conn_type == connection_type.UDP:\n            code, message = self.parse_request(conn, client_address)\n            self.sock.sendto(bytes(str(self.create_response(code, message)).encode('utf-8')), client_address)\n        elif self.conn_type == connection_type.TCP:\n            while True:\n                data = conn.recv(max_data_size)\n                if not data:\n                    print(\"Connection close\")\n                    conn.close()\n                    break\n                code, message = self.parse_request(data, client_address)\n                conn.send(bytes(str(self.create_response(code, message)).encode('utf-8')))\n\n    def parse_request(self, data, client_address):\n        out = {}\n        out[\"client_address\"] = client_address\n        _data = data.decode('utf-8')\n        lines = _data.split('\\r\\n')\n        print(f\"Recieved data (&lt;= {max_data_size / 1024.0} Kb) from {client_address}: {data.decode('utf-8')}\")\n        if len(_data) == 0:\n            return \"\"\n        method, path, _ = lines[0].split(' ')\n        method = method.strip()\n        args = \"\"\n        if '?' in path:\n            path, args = path.strip().split('?')\n        out[\"path\"] = path\n\n        if method == 'POST':\n            out[\"method\"] = method_type.POST\n            body = str(lines[-1]).strip()\n            out[\"body\"] = body\n            if body.startswith(\"{\"):\n                out[\"json\"] = json.loads(body)\n        elif method == 'GET':\n            out[\"method\"] = method_type.GET\n            if args:\n                args_dict = {}\n                for arg in args.split(\"&amp;\"):\n                    key, val = arg.split(\"=\")\n                    args_dict[key] = val\n                out[\"args\"] = args_dict\n\n        if out[\"method\"] not in self.routes or out[\"path\"] not in self.routes[out[\"method\"]]:\n            return (404, \"Resource not found\")\n\n        return self.routes[out[\"method\"]][out[\"path\"]](out)\n\n    def create_response(self, code, body):\n        length = len(body.encode('utf-8'))\n        return f\"HTTP/1.1 {code} OK\\nContent-Type: application/json,text/html; charset=utf-8\\nConnection: keep-alive\\nAccess-Control-Allow-Origin: *\\nContent-Length: {length}\\n\\n\" + body\n\n    def add_route(self, method : method_type, route : str, handler):\n        if method not in self.routes:\n            self.routes[method] = {}\n        self.routes[method][route] = handler\n</code></pre>"},{"location":"report_2/","title":"\u041e\u0442\u0447\u0451\u0442 \u043f\u043e \u043b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u0435 \u21162","text":"<p>\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u043b \u0410\u043d\u0438\u0441\u0438\u043c\u043e\u0432 \u0412\u043b\u0430\u0434\u0438\u0441\u043b\u0430\u0432 \u041a3340   </p>"},{"location":"report_2/#_1","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435","text":"<ol> <li> <p>\u0414\u043e\u0441\u043a\u0430 \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u0445 \u0437\u0430\u0434\u0430\u043d\u0438\u0439.  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u041e \u0434\u043e\u043c\u0430\u0448\u043d\u0435\u043c \u0437\u0430\u0434\u0430\u043d\u0438\u0438 \u0434\u043e\u043b\u0436\u043d\u0430 \u0445\u0440\u0430\u043d\u0438\u0442\u044c\u0441\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f:  \u043f\u0440\u0435\u0434\u043c\u0435\u0442, \u043f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u044c, \u0434\u0430\u0442\u0430 \u0432\u044b\u0434\u0430\u0447\u0438, \u043f\u0435\u0440\u0438\u043e\u0434 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f, \u0442\u0435\u043a\u0441\u0442 \u0437\u0430\u0434\u0430\u043d\u0438\u044f, \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0448\u0442\u0440\u0430\u0444\u0430\u0445.  \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b:   </p> </li> <li> <p>\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u043e\u0432\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439.</p> </li> <li>\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u0445 \u0437\u0430\u0434\u0430\u043d\u0438\u0439 \u043f\u043e \u0432\u0441\u0435\u043c \u0434\u0438\u0441\u0446\u0438\u043f\u043b\u0438\u043d\u0430\u043c (\u0441\u0440\u043e\u043a\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f, \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u044f).</li> <li>\u0421\u0434\u0430\u0447\u0430 \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u0445 \u0437\u0430\u0434\u0430\u043d\u0438\u0439 \u0432 \u0442\u0435\u043a\u0441\u0442\u043e\u0432\u043e\u043c \u0432\u0438\u0434\u0435.</li> <li>\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440 (\u0443\u0447\u0438\u0442\u0435\u043b\u044c) \u0434\u043e\u043b\u0436\u0435\u043d \u0438\u043c\u0435\u0442\u044c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043e\u0446\u0435\u043d\u043a\u0443 \u0437\u0430 \u0437\u0430\u0434\u0430\u043d\u0438\u0435 \u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0430\u043c\u0438 Django-admin.</li> <li>\u0412 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0439 \u0447\u0430\u0441\u0442\u0438 \u0434\u043e\u043b\u0436\u043d\u0430 \u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u0430, \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u044e\u0449\u0430\u044f \u043e\u0446\u0435\u043d\u043a\u0438 \u0432\u0441\u0435\u0445 \u0443\u0447\u0435\u043d\u0438\u043a\u043e\u0432 \u043a\u043b\u0430\u0441\u0441\u0430.</li> </ol>"},{"location":"report_2/#_2","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435","text":"<p>\u0421\u043e\u0437\u0434\u0430\u0434\u0438\u043c 2 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f: \u0434\u043b\u044f \u0430\u0443\u043d\u0442\u0435\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u0438 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0435, \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043e\u0442\u0432\u0435\u0447\u0430\u0435\u0442 \u0437\u0430 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445   </p>"},{"location":"report_2/#url","title":"\u041f\u0440\u043e\u043f\u0438\u0448\u0435\u043c url:","text":"<ul> <li>\u0414\u043b\u044f \u0433\u043b\u0430\u0432\u043d\u043e\u0433\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f</li> </ul> <pre><code>urlpatterns = [\n    path('admin/', admin.site.urls),\n    path('accounts/', include('accounts.urls')),\n    path('', include('main.urls')),\n]\n</code></pre> <ul> <li>\u0414\u043b\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f main:</li> </ul> <pre><code>urlpatterns = [\n    path('', table, name='table'),\n    path('upload/', upload, name='upload'),\n    path('grades/', grades, name='grades'),\n]\n</code></pre> <ul> <li>\u0414\u043b\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f accounts:</li> </ul> <pre><code>urlpatterns = [\n    path('login/', login, name='login'),\n    path('register/', register, name='register'),\n    path('logout/', logout, name='logout'),\n]\n</code></pre>"},{"location":"report_2/#view","title":"\u0421\u0434\u0435\u043b\u0430\u0435\u043c view:","text":"<ul> <li>\u0414\u043b\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f accounts:</li> </ul> <pre><code>from django.shortcuts import render, redirect\nfrom django.contrib.auth import login as _login, logout as _logout\nfrom django.contrib.auth.hashers import make_password\nfrom .forms import UserRegisterForm, UserLoginForm\n\ndef register(request):\n    if request.method == \"POST\":\n        form = UserRegisterForm(request.POST)\n        if form.is_valid():\n            user = form.save(commit=False)  # Don't save yet, we need to hash the password\n            user.password = make_password(form.cleaned_data['password'])\n            user.save()\n            _login(request, user)\n            return redirect(\"/\")\n    else:\n        if str(request.user) != \"AnonymousUser\": return redirect(\"/\")\n        form = UserRegisterForm()\n    return render(request, 'register.html', {'form': form})\n\ndef login(request):\n    if request.method == \"POST\":\n        form = UserLoginForm(data=request.POST)\n        if form.is_valid():\n            _login(request, form.get_user())\n            return redirect(\"/\")\n    else:\n        if str(request.user) != \"AnonymousUser\": return redirect(\"/\")\n        form = UserLoginForm()\n    return render(request, 'login.html', {'form': form})\n\ndef logout(request):\n    _logout(request)\n    return redirect('/accounts/login')\n</code></pre> <ul> <li>\u0414\u043b\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f main:</li> </ul> <pre><code>import json\nfrom django.shortcuts import render, redirect, get_object_or_404\nfrom django.contrib.auth.decorators import login_required\nfrom django.views.decorators.http import require_POST\nfrom django.http import JsonResponse\nfrom collections import defaultdict\nfrom accounts.models import *\nfrom .models import *\n\n@login_required\ndef table(request):\n    if request.user.user_type != \"student\":\n        user = get_object_or_404(User, username=request.user.username)\n        return redirect(\"/admin\")\n    else:\n        user = get_object_or_404(User, username=request.user.username)\n\n        subjects = Subject.objects.filter(classname=user.classname)\n\n        selected_subject_id : int = request.GET.get('subject_id')\n        selected_subject = None\n        assignments = []\n\n        if selected_subject_id:\n            try:\n                selected_subject = subjects.filter(id=selected_subject_id)[0]\n                assignments = Assignment.objects.filter(subject=selected_subject).order_by('-date_of_issue')\n                solutions = Solution.objects.filter(assignment__subject=selected_subject, student=user)    \n\n                solutions_dict = {sol.assignment_id: sol for sol in solutions}\n\n                for assignment in assignments:\n                    solution = solutions_dict.get(assignment.id)\n                    assignment.link_to_file = solution.link_to_file if solution else None\n                    assignment.grade = solution.grade if solution else None\n\n            except Subject.DoesNotExist:\n                pass\n\n        context = {\n            'user': user,\n            'subjects': subjects,\n            'selected_subject': selected_subject,\n            'assignments': assignments,\n        }\n\n        return render(request, 'table.html', context)\n\n@login_required\n@require_POST\ndef upload(request):\n    try:\n        data = json.loads(request.body)\n        assignment_id = data.get('assignment_id')\n        subject_id = data.get('subject_id')\n        file_url = data.get('file_url')\n\n        assignment = Assignment.objects.get(id=assignment_id, subject_id=subject_id)\n        Solution.objects.create(assignment=assignment,student=request.user,link_to_file=file_url)\n\n        return JsonResponse({\n            'success': True,\n            'message': '\u0420\u0435\u0448\u0435\u043d\u0438\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u0440\u0438\u043a\u0440\u0435\u043f\u043b\u0435\u043d\u043e'\n        })\n\n    except Assignment.DoesNotExist:\n        return JsonResponse({\n            'success': False,\n            'error': '\u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e'\n        }, status=404)\n    except Exception as e:\n        return JsonResponse({\n            'success': False,\n            'error': str(e)\n        }, status=500)\n\n@login_required\ndef grades(request):\n    if request.user.user_type != \"student\":\n        user = get_object_or_404(User, username=request.user.username)\n        return redirect(\"/admin\")\n    else:\n        #data = json.loads(request.body)\n        user = get_object_or_404(User, username=request.user.username)\n        subjects = Subject.objects.filter(classname=user.classname)\n        selected_subject_id : int = request.GET.get('subject_id')\n        subject = Subject.objects.get(id=selected_subject_id)\n\n        students = User.objects.filter(classname=user.classname, is_staff=False).order_by('full_name')\n\n        assignments = Assignment.objects.filter(subject=subject).order_by('date_of_issue')\n\n        solutions = Solution.objects.filter(assignment__in=assignments, student__in=students).select_related('assignment', 'student')\n        student_grades = defaultdict(dict)\n        for solution in solutions:\n            student_grades[solution.student_id][solution.assignment_id] = {\n                'grade': None if solution.grade is None else int(solution.grade),\n                'link_to_file': solution.link_to_file\n            }\n\n        grades_data = []\n        for student in students:\n            student_row = {\n                'student': student,\n                'grades': []\n            }\n            for assignment in assignments:\n                grade_info = student_grades[student.id].get(assignment.id)\n                student_row['grades'].append(grade_info)\n            grades_data.append(student_row)\n\n        context = {\n            'user': user,\n            'subjects': subjects,\n            'selected_subject': subject,\n            'students': students,\n            'assignments': assignments,\n            'grades_data': grades_data,\n        }\n\n        return render(request, 'grades.html', context)\n\n</code></pre>"},{"location":"report_2/#_3","title":"\u041c\u043e\u0434\u0435\u043b\u0438 \u0432\u044b\u0433\u043b\u044f\u0434\u044f\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c:","text":"<ul> <li>\u0414\u043b\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f accounts:</li> </ul> <pre><code>from django.db import models\nfrom django.contrib.auth.models import AbstractBaseUser, BaseUserManager, PermissionsMixin\nfrom main.base_models import *\n\nclass CustomUserManager(BaseUserManager):\n    def create_user(self, username, password=None, **extra_fields):\n        user = self.model(username=username, **extra_fields)\n        user.set_password(password)\n        user.save(using=self._db)\n        return user\n\n    def create_superuser(self, username, password=None, **extra_fields):\n        extra_fields.setdefault('user_type', 'admin')\n        extra_fields.setdefault('is_staff', True)\n        extra_fields.setdefault('is_superuser', True)\n        return self.create_user(username, password, **extra_fields)\n\nclass User(AbstractBaseUser, PermissionsMixin):\n    USER_TYPES = (\n        ('student', '\u0423\u0447\u0435\u043d\u0438\u043a'),\n        ('teacher', '\u0423\u0447\u0438\u0442\u0435\u043b\u044c'),\n        ('admin', '\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440'),\n    )\n    classname = models.ForeignKey(Class, on_delete=models.DO_NOTHING, null=True, blank=True)\n    user_type = models.CharField(max_length=10, choices=USER_TYPES, default='student')\n    username = models.CharField(max_length=32, unique=True, db_index=True)\n    full_name = models.CharField(max_length=64)\n    password = models.CharField(max_length=128)\n    is_staff = models.BooleanField(default=False)\n    REQUIRED_FIELDS = ['password']\n    USERNAME_FIELD = 'username'\n    objects = CustomUserManager()\n\n    def __str__(self):\n        return self.username\n</code></pre> <ul> <li>\u0414\u043b\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f main:</li> </ul> <pre><code>from django.db import models\nfrom .base_models import *\nfrom accounts.models import *\n\nclass Subject(models.Model):\n    teacher = models.ForeignKey(User, on_delete=models.CASCADE)\n    classname = models.ForeignKey(Class, on_delete=models.CASCADE)\n    name = models.CharField(max_length=32)\n    def __str__(self):\n        return self.name\n\nclass Assignment(models.Model):\n    subject = models.ForeignKey(Subject, on_delete=models.CASCADE)\n    name = models.CharField(max_length=64)\n    text = models.CharField(max_length=256)\n    penalty_info = models.CharField(max_length=128)\n    date_of_issue = models.DateTimeField()\n    end_date = models.DateTimeField()\n    def __str__(self):\n        return self.name[:16]\n\nclass Solution(models.Model):\n    assignment = models.ForeignKey(Assignment, on_delete=models.CASCADE)\n    student = models.ForeignKey(User, on_delete=models.CASCADE)\n    grade = models.IntegerField(null=True, blank=True)\n    link_to_file = models.CharField(max_length=128, null=True, blank=True)\n</code></pre>"},{"location":"report_3/","title":"\u041b\u0430\u0431\u043e\u0440\u0430\u0442\u043e\u0440\u043d\u0430\u044f \u0440\u0430\u0431\u043e\u0442\u0430 3","text":""},{"location":"report_3/#_1","title":"\u0421\u0445\u0435\u043c\u0430 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445","text":""},{"location":"report_3/#modelspy","title":"models.py","text":"<pre><code>from django.contrib.auth.models import AbstractUser\nfrom django.db import models\n\nclass FuelType(models.IntegerChoices):\n    GASOLINE_1 = 1, '\u0410\u0418-92'\n    GASOLINE_2 = 2, '\u0410\u0418-95'\n    GASOLINE_3 = 3, '\u0410\u0418-98'\n    GASOLINE_4 = 4, '\u0410\u0418-100'\n    DIESEL = 5, '\u0414\u0422'\n    ELECTRIC = 6, '\u042d\u043b\u0435\u043a\u0442\u0440\u0438\u0447\u0435\u0441\u043a\u0438\u0439'\n    HYBRID = 7, '\u0413\u0438\u0431\u0440\u0438\u0434'\n\nclass TransmissionType(models.TextChoices):\n    AUTO = 'A', '\u0410\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f'\n    MANUAL = 'M', '\u041c\u0435\u0445\u0430\u043d\u0438\u0447\u0435\u0441\u043a\u0430\u044f'\n\nclass User(AbstractUser):\n    #full_name = models.CharField('\u041f\u043e\u043b\u043d\u043e\u0435 \u0438\u043c\u044f', max_length=128)\n    passport = models.CharField('\u041f\u0430\u0441\u043f\u043e\u0440\u0442\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435', max_length=32)\n    phone = models.CharField('\u0422\u0435\u043b\u0435\u0444\u043e\u043d', max_length=16)\n\n    REQUIRED_FIELDS = ['first_name', 'last_name', 'phone', 'password', 'phone', 'passport']\n\n    class Meta:\n        verbose_name = '\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c'\n        verbose_name_plural = '\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438'\n\n    def __str__(self):\n        return f\"{self.first_name} {self.last_name}\"\n\nclass Client(models.Model):\n    user = models.OneToOneField(\n        User, \n        on_delete=models.CASCADE,\n        related_name='client',\n    )\n\n    class Meta:\n        verbose_name = '\u041a\u043b\u0438\u0435\u043d\u0442'\n        verbose_name_plural = '\u041a\u043b\u0438\u0435\u043d\u0442\u044b'\n\n    def __str__(self):\n        return f\"{self.user.first_name} {self.user.last_name}\"\n\nclass Worker(models.Model):\n    salary = models.IntegerField('\u0417\u0430\u0440\u043f\u043b\u0430\u0442\u0430')\n    position = models.CharField('\u0414\u043e\u043b\u0436\u043d\u043e\u0441\u0442\u044c', max_length=64)\n    user = models.OneToOneField(\n        User, \n        on_delete=models.CASCADE,\n        related_name='worker',\n    )\n\n    class Meta:\n        verbose_name = '\u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a'\n        verbose_name_plural = '\u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0438'\n\n    def __str__(self):\n        return f\"{self.position}: {self.user.first_name + \" \" + self.user.last_name}\"\n\nclass CarInfo(models.Model):\n    brand = models.CharField('\u041c\u0430\u0440\u043a\u0430', max_length=32)\n    model = models.CharField('\u041c\u043e\u0434\u0435\u043b\u044c', max_length=32)\n    description = models.TextField('\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435', blank=True, null=True)\n\n    class Meta:\n        verbose_name = '\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0435'\n        verbose_name_plural = '\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044f\u0445'\n\n    def __str__(self):\n        return f\"{self.brand} {self.model}\"\n\nclass Car(models.Model):\n    capacity = models.IntegerField('\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0435\u0441\u0442')\n    engine_volume = models.FloatField('\u041e\u0431\u044a\u0451\u043c \u0434\u0432\u0438\u0433\u0430\u0442\u0435\u043b\u044f')\n    horsepower = models.IntegerField('\u041c\u043e\u0449\u043d\u043e\u0441\u0442\u044c \u0434\u0432\u0438\u0433\u0430\u0442\u0435\u043b\u044f')\n    fuel_type = models.IntegerField(\n        '\u0422\u0438\u043f \u0442\u043e\u043f\u043b\u0438\u0432\u0430',\n        choices=FuelType.choices\n    )\n    transmission = models.CharField(\n        '\u0422\u0438\u043f \u041a\u041f\u041f',\n        max_length=20,\n        choices=TransmissionType.choices\n    )\n    clearance = models.FloatField('\u0414\u043e\u0440\u043e\u0436\u043d\u044b\u0439 \u043f\u0440\u043e\u0441\u0432\u0435\u0442')\n    trunk_volume = models.IntegerField('\u041e\u0431\u044a\u0435\u043c \u0431\u0430\u0433\u0430\u0436\u043d\u0438\u043a\u0430')\n    tank_volume = models.IntegerField('\u041e\u0431\u044a\u0451\u043c \u0442\u043e\u043f\u043b\u0438\u0432\u043d\u043e\u0433\u043e \u0431\u0430\u043a\u0430')\n    fuel_consumption = models.FloatField('\u0420\u0430\u0441\u0445\u043e\u0434 \u0442\u043e\u043f\u043b\u0438\u0432\u0430')\n    gen = models.CharField('\u041f\u043e\u043a\u043e\u043b\u0435\u043d\u0438\u0435', max_length=32,)\n    car_info = models.ForeignKey(\n        CarInfo,\n        on_delete=models.CASCADE,\n        related_name='cars',\n    )\n\n    class Meta:\n        verbose_name = '\u0410\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044c'\n        verbose_name_plural = '\u0410\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0438'\n\n    def __str__(self):\n        return f\"{self.car_info} {self.transmission}\"\n\nclass CarInstance(models.Model):\n    license_plate = models.CharField('\u0413\u043e\u0441\u043d\u043e\u043c\u0435\u0440', max_length=20)\n    vincode = models.CharField('VIN-\u043a\u043e\u0434', max_length=50)\n    price = models.IntegerField('\u0426\u0435\u043d\u0430 \u043f\u0440\u043e\u043a\u0430\u0442\u0430')\n    color = models.CharField('\u0426\u0432\u0435\u0442', max_length=32)\n    year = models.IntegerField('\u0413\u043e\u0434')\n    car = models.ForeignKey(\n        Car,\n        on_delete=models.CASCADE,\n        related_name='instances',\n    )\n\n    class Meta:\n        verbose_name = '\u042d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044f'\n        verbose_name_plural = '\u042d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u044b \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0435\u0439'\n\n    def __str__(self):\n        return f\"{self.license_plate} - {self.car.car_info.brand} {self.car.car_info.model}\"\n\nclass RentContract(models.Model):\n    start_date = models.DateTimeField('\u0414\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430 \u0430\u0440\u0435\u043d\u0434\u044b')\n    return_date = models.DateTimeField('\u041f\u043b\u0430\u043d\u0438\u0440\u0443\u0435\u043c\u0430\u044f \u0434\u0430\u0442\u0430 \u0432\u043e\u0437\u0432\u0440\u0430\u0442\u0430')\n    real_return_date = models.DateTimeField(\n        '\u0424\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0434\u0430\u0442\u0430 \u0432\u043e\u0437\u0432\u0440\u0430\u0442\u0430',\n        blank=True,\n        null=True\n    )\n    client = models.ForeignKey(\n        Client,\n        on_delete=models.CASCADE,\n        related_name='contracts',\n    )\n    car_instance = models.ForeignKey(\n        CarInstance,\n        on_delete=models.CASCADE,\n        related_name='contracts',\n    )\n    worker = models.ForeignKey(\n        Worker,\n        on_delete=models.CASCADE,\n        related_name='contracts',\n    )\n\n    class Meta:\n        verbose_name = '\u0414\u043e\u0433\u043e\u0432\u043e\u0440 \u0430\u0440\u0435\u043d\u0434\u044b'\n        verbose_name_plural = '\u0414\u043e\u0433\u043e\u0432\u043e\u0440\u044b \u0430\u0440\u0435\u043d\u0434\u044b'\n\n    def __str__(self):\n        return f\"\u0414\u043e\u0433\u043e\u0432\u043e\u0440 {self.id} - {self.client}\"\n\nclass Fine(models.Model):\n    date = models.DateTimeField('\u0414\u0430\u0442\u0430 \u0448\u0442\u0440\u0430\u0444\u0430')\n    cost = models.FloatField('\u0421\u0443\u043c\u043c\u0430 \u0448\u0442\u0440\u0430\u0444\u0430')\n    description = models.TextField('\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435')\n    car_instance = models.ForeignKey(\n        CarInstance,\n        on_delete=models.CASCADE,\n        related_name='fines',\n        verbose_name='\u042d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044f'\n    )\n\n    class Meta:\n        verbose_name = '\u0428\u0442\u0440\u0430\u0444'\n        verbose_name_plural = '\u0428\u0442\u0440\u0430\u0444\u044b'\n\n    def __str__(self):\n        return f\"\u0428\u0442\u0440\u0430\u0444 {self.date.strftime('%Y-%m-%d')} - {self.cost} \u0440\u0443\u0431.\"\n\nclass CarCrash(models.Model):\n    date = models.DateTimeField('\u0414\u0430\u0442\u0430 \u0430\u0432\u0430\u0440\u0438\u0438')\n    damage = models.FloatField('\u0423\u0449\u0435\u0440\u0431')\n    info = models.TextField('\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431 \u0430\u0432\u0430\u0440\u0438\u0438')\n    car_instance = models.ForeignKey(\n        CarInstance,\n        on_delete=models.CASCADE,\n        related_name='crashes',\n    )\n\n    class Meta:\n        verbose_name = '\u0410\u0432\u0430\u0440\u0438\u044f'\n        verbose_name_plural = '\u0410\u0432\u0430\u0440\u0438\u0438'\n\n    def __str__(self):\n        return f\"\u0410\u0432\u0430\u0440\u0438\u044f {self.date.strftime('%Y-%m-%d')}  \u043d\u0430 \u0441\u0443\u043c\u043c\u0443 {self.damage}\"\n\n</code></pre>"},{"location":"report_3/#serializerspy","title":"serializers.py","text":"<pre><code>from rest_framework import serializers\nfrom .models import *\n\nclass CarInfoSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = CarInfo\n        fields = \"__all__\"\n\nclass CarSerializer(serializers.ModelSerializer):\n    def to_representation(self, instance):\n        representation = super().to_representation(instance)\n        representation['car_info'] = CarInfoSerializer(instance.car_info).data\n        return representation\n\n    class Meta:\n        model = Car\n        fields = \"__all__\"\n\nclass FineSerializer(serializers.ModelSerializer):\n    def to_representation(self, instance):\n        representation = super().to_representation(instance)\n        representation['car_instance'] = instance.car_instance.__str__()\n        return representation\n\n    class Meta:\n        model = Fine\n        fields = \"__all__\"\n\nclass CarCrashSerializer(serializers.ModelSerializer):\n    def to_representation(self, instance):\n        representation = super().to_representation(instance)\n        representation['car_instance'] = instance.car_instance.__str__()\n        return representation\n\n    class Meta:\n        model = CarCrash\n        fields = \"__all__\"\n\nclass CarInstanceSerializer(serializers.ModelSerializer):\n    fines = FineSerializer(many=True, read_only=True)\n    crashes = CarCrashSerializer(many=True, read_only=True)\n\n    def to_representation(self, instance):\n        representation = super().to_representation(instance)\n        representation['car'] = CarSerializer(instance.car).data\n        representation['fines'] = list(map(lambda el: el[\"description\"], representation['fines']))\n        representation['crashes'] = list(map(lambda el: el[\"info\"], representation['crashes']))\n        return representation\n\n    class Meta:\n        model = CarInstance\n        fields = \"__all__\"\n\nclass ClientSerializer(serializers.ModelSerializer):\n    def to_representation(self, instance):\n        representation = super().to_representation(instance)\n        user = User.objects.get(id=representation['user'])\n        representation['user'] = f\"{user.first_name} {user.last_name}\"\n        return representation\n\n    class Meta:\n        model = Client\n        fields = \"__all__\"\n\nclass WorkerSerializer(serializers.ModelSerializer):\n    def to_representation(self, instance):\n        representation = super().to_representation(instance)\n        user = User.objects.get(id=representation['user'])\n        representation['user'] = f\"{user.first_name} {user.last_name}\"\n        return representation\n\n    class Meta:\n        model = Worker\n        fields = \"__all__\"\n\nclass RentContractSerializer(serializers.ModelSerializer):\n    def to_representation(self, instance):\n        representation = super().to_representation(instance)\n        representation['worker'] = WorkerSerializer(instance.worker).data['user']\n        representation['client'] = ClientSerializer(instance.client).data['user']\n        representation['car_instance'] = instance.car_instance.__str__()\n        return representation\n\n    class Meta:\n        model = RentContract\n        fields = \"__all__\"\n</code></pre>"},{"location":"report_3/#viewspy","title":"views.py","text":"<pre><code>from rest_framework.views import APIView\nfrom rest_framework.response import Response\nfrom rest_framework import generics, viewsets\nfrom django.db.models import Count, Max, Sum, F, Q\nfrom django.db.models.functions import Concat\nfrom .models import *\nfrom .serializers import *\n\nclass CarInfoAPIViewSet(viewsets.ModelViewSet):\n    serializer_class = CarInfoSerializer\n    queryset = CarInfo.objects.all()\n\nclass CarAPIViewSet(viewsets.ModelViewSet):\n    serializer_class = CarSerializer\n    queryset = Car.objects.all()\n\nclass CarInstanceAPIViewSet(viewsets.ModelViewSet):\n    serializer_class = CarInstanceSerializer\n    queryset = CarInstance.objects.all()\n\nclass FineAPIViewSet(viewsets.ModelViewSet):\n    serializer_class = FineSerializer\n    queryset = Fine.objects.all()\n\nclass CarCrashAPIViewSet(viewsets.ModelViewSet):\n    serializer_class = CarCrashSerializer\n    queryset = CarCrash.objects.all()\n\nclass ClientAPIViewSet(viewsets.ModelViewSet):\n    serializer_class = ClientSerializer\n    queryset = Client.objects.all()\n\nclass WorkerAPIViewSet(viewsets.ModelViewSet):\n    serializer_class = WorkerSerializer\n    queryset = Worker.objects.all()\n\nclass RentContractAPIViewSet(viewsets.ModelViewSet):\n    serializer_class = RentContractSerializer\n    queryset = RentContract.objects.all()\n\nclass TimesRentedAPIView(APIView):\n    def get(self, request):\n        annotated = CarInstance.objects.annotate(count=Count('contracts'))\n        return Response(dict([(car_instance.__str__(), car_instance.count) for car_instance in annotated]))\n\nclass DaysRentedAPIView(APIView):\n    def get(self, request):\n        annotated = CarInstance.objects.annotate(date=Sum(F('contracts__return_date') - F('contracts__start_date')))\n        return Response(dict([(car_instance.__str__(), car_instance.date.days) for car_instance in annotated]))\n\nclass ProfitByCarAPIView(APIView):\n    def get(self, request):\n        annotated = CarInstance.objects.annotate(date=Sum(F('contracts__return_date') - F('contracts__start_date')))\n        return Response(dict([(car_instance.__str__(), car_instance.date.days * car_instance.price) for car_instance in annotated]))\n\nclass FinesByClientAPIView(APIView):\n    def get(self, request):\n        annotated = Fine.objects.annotate(client=F(\"car_instance__contracts__client\"),\n                                          name=Concat(\"car_instance__contracts__client__user__first_name\",  \n                                                      models.Value(' '), \n                                                      \"car_instance__contracts__client__user__last_name\"),\n                                          start=F(\"car_instance__contracts__start_date\"), \n                                          end=F(\"car_instance__contracts__return_date\")).filter(start__lt=F('date'), end__gt=F('date'))\n\n        return Response(dict([(client['name'], client['count']) for client in annotated.values(\"client\").annotate(count=Count('client'), name=F('name'))]))\n</code></pre>"},{"location":"report_3/#urlspy","title":"urls.py","text":"<pre><code>from django.urls import path, include\nfrom rest_framework.routers import DefaultRouter\nfrom .views import *\n\napp_name = \"core\"\n\nrouter = DefaultRouter()\nrouter.register(r'car_infos', CarInfoAPIViewSet)\nrouter.register(r'cars', CarAPIViewSet)\nrouter.register(r'car_instances', CarInstanceAPIViewSet)\nrouter.register(r'fines', FineAPIViewSet)\nrouter.register(r'car_crashes', CarCrashAPIViewSet)\nrouter.register(r'clients', ClientAPIViewSet)\nrouter.register(r'workers', WorkerAPIViewSet)\nrouter.register(r'rent_contracts', RentContractAPIViewSet)\n\nurlpatterns = [\n    path('', include(router.urls)),\n    path('times_rented', TimesRentedAPIView.as_view()),\n    path('days_rented', DaysRentedAPIView.as_view()),\n    path('profit_by_car', ProfitByCarAPIView.as_view()),\n    path('\u0448\u0442\u0440\u0430\u0444by_client', FinesByClientAPIView.as_view()),\n]\n</code></pre>"},{"location":"report_3/#endpoint-","title":"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f \u043f\u043e endpoint-\u0430\u043c","text":""},{"location":"report_3/#car_infos","title":"car_infos","text":"\u041c\u0435\u0442\u043e\u0434 URL \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 GET <code>/core/car_infos/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e\u0431 \u0430\u0432\u0442\u043e POST <code>/core/car_infos/</code> \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0431 \u0430\u0432\u0442\u043e GET <code>/core/car_infos/&lt;id&gt;/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0431 \u0430\u0432\u0442\u043e PUT <code>/core/car_infos/&lt;id&gt;/</code> \u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0431 \u0430\u0432\u0442\u043e PATCH <code>/core/car_infos/&lt;id&gt;/</code> \u0427\u0430\u0441\u0442\u0438\u0447\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0431 \u0430\u0432\u0442\u043e DELETE <code>/core/car_infos/&lt;id&gt;/</code> \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e\u0431 \u0430\u0432\u0442\u043e"},{"location":"report_3/#cars","title":"cars","text":"\u041c\u0435\u0442\u043e\u0434 URL \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 GET <code>/core/cars/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0435\u0439 POST <code>/core/cars/</code> \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044c GET <code>/core/cars/&lt;id&gt;/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044c PUT <code>/core/cars/&lt;id&gt;/</code> \u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044c PATCH <code>/core/cars/&lt;id&gt;/</code> \u0427\u0430\u0441\u0442\u0438\u0447\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044c DELETE <code>/core/cars/&lt;id&gt;/</code> \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044c"},{"location":"report_3/#car_instances","title":"car_instances","text":"\u041c\u0435\u0442\u043e\u0434 URL \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 GET <code>/core/car_instances/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u043e\u0432 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0435\u0439 POST <code>/core/car_instances/car_instances/</code> \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044f GET <code>/core/car_instances/&lt;id&gt;/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044f PUT <code>/core/car_instances/&lt;id&gt;/</code> \u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044f PATCH <code>/core/car_instances/&lt;id&gt;/</code> \u0427\u0430\u0441\u0442\u0438\u0447\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044f DELETE <code>/core/car_instances/&lt;id&gt;/</code> \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044f"},{"location":"report_3/#fines","title":"fines","text":"\u041c\u0435\u0442\u043e\u0434 URL \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 GET <code>/core/fines/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0441\u0435\u0445 \u0448\u0442\u0440\u0430\u0444\u043e\u0432 POST <code>/core/fines/</code> \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0448\u0442\u0440\u0430\u0444 GET <code>/core/fines/&lt;id&gt;/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u0448\u0442\u0440\u0430\u0444 PUT <code>/core/fines/&lt;id&gt;/</code> \u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0448\u0442\u0440\u0430\u0444 PATCH <code>/core/fines/&lt;id&gt;/</code> \u0427\u0430\u0441\u0442\u0438\u0447\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0448\u0442\u0440\u0430\u0444 DELETE <code>/core/fines/&lt;id&gt;/</code> \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0448\u0442\u0440\u0430\u0444"},{"location":"report_3/#car_crashes","title":"car_crashes","text":"\u041c\u0435\u0442\u043e\u0434 URL \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 GET <code>/core/car_crashes/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0414\u0422\u041f POST <code>/core/car_crashes/</code> \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0414\u0422\u041f GET <code>/core/car_crashes/&lt;id&gt;/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u0414\u0422\u041f PUT <code>/core/car_crashes/&lt;id&gt;/</code> \u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0414\u0422\u041f PATCH <code>/core/car_crashes/&lt;id&gt;/</code> \u0427\u0430\u0441\u0442\u0438\u0447\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0414\u0422\u041f DELETE <code>/core/car_crashes/&lt;id&gt;/</code> \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0414\u0422\u041f"},{"location":"report_3/#clients","title":"clients","text":"\u041c\u0435\u0442\u043e\u0434 URL \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 GET <code>/core/clients/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432 POST <code>/core/clients/</code> \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442\u0430 GET <code>/core/clients/&lt;id&gt;/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043a\u043b\u0438\u0435\u043d\u0442\u0430 PUT <code>/core/clients/&lt;id&gt;/</code> \u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442 PATCH <code>/core/clients/&lt;id&gt;/</code> \u0427\u0430\u0441\u0442\u0438\u0447\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442 DELETE <code>/core/clients/&lt;id&gt;/</code> \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u043b\u0438\u0435\u043d\u0442"},{"location":"report_3/#workers","title":"workers","text":"\u041c\u0435\u0442\u043e\u0434 URL \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 GET <code>/core/workers/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0440\u0430\u0431\u043e\u0442\u043d\u0438\u043a\u043e\u0432 POST <code>/core/workers/</code> \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u043d\u0438\u043a\u0430 GET <code>/core/workers/&lt;id&gt;/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0440\u0430\u0431\u043e\u0442\u043d\u0438\u043a PUT <code>/core/workers/&lt;id&gt;/</code> \u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u043d\u0438\u043a PATCH <code>/core/workers/&lt;id&gt;/</code> \u0427\u0430\u0441\u0442\u0438\u0447\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u043d\u0438\u043a DELETE <code>/core/workers/&lt;id&gt;/</code> \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u043d\u0438\u043a\u0430"},{"location":"report_3/#rent_contracts","title":"rent_contracts","text":"\u041c\u0435\u0442\u043e\u0434 URL \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 GET <code>/core/rent_contracts/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0434\u043e\u0433\u043e\u0432\u043e\u0440\u043e\u0432 \u0430\u0440\u0435\u043d\u0434\u044b POST <code>/core/rent_contracts/</code> \u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0434\u043e\u0433\u043e\u0432\u043e\u0440 \u0430\u0440\u0435\u043d\u0434\u044b GET <code>/core/rent_contracts/&lt;id&gt;/</code> \u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u0434\u043e\u0433\u043e\u0432\u043e\u0440 \u0430\u0440\u0435\u043d\u0434\u044b PUT <code>/core/rent_contracts/&lt;id&gt;/</code> \u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u043e\u0433\u043e\u0432\u043e\u0440 \u0430\u0440\u0435\u043d\u0434\u044b PATCH <code>/core/rent_contracts/&lt;id&gt;/</code> \u0427\u0430\u0441\u0442\u0438\u0447\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u043e\u0433\u043e\u0432\u043e\u0440 \u0430\u0440\u0435\u043d\u0434\u044b DELETE <code>/core/rent_contracts/&lt;id&gt;/</code> \u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0434\u043e\u0433\u043e\u0432\u043e\u0440 \u0430\u0440\u0435\u043d\u0434\u044b"},{"location":"report_3/#_2","title":"\u0414\u043e\u043f. \u0437\u0430\u043f\u0440\u043e\u0441\u044b","text":"\u041c\u0435\u0442\u043e\u0434 URL \u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 GET <code>/core/days_rented/</code> \u0421\u0443\u043c\u043c\u0430\u0440\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043d\u0435\u0439, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0431\u044b\u043b \u0430\u0440\u0435\u043d\u0434\u043e\u0432\u0430\u043d \u043a\u0430\u0436\u0434\u044b\u0439 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044c GET <code>/core/times_rented/</code> \u0421\u043a\u043e\u043b\u044c\u043a\u043e \u0440\u0430\u0437 \u0431\u044b\u043b \u0430\u0440\u0435\u043d\u0434\u043e\u0432\u0430\u043d \u043a\u0430\u0436\u0434\u044b\u0439 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u044c GET <code>/core/fines_by_client/</code> \u0421\u043a\u043e\u043b\u044c\u043a\u043e \u0448\u0442\u0440\u0430\u0444\u043e\u0432 \u0441\u043e\u0431\u0440\u0430\u043b \u043a\u043b\u0438\u0435\u043d\u0442 GET <code>/core/profit_by_car/</code> \u0421\u043a\u043e\u043b\u044c\u043a\u043e \u0434\u0435\u043d\u0435\u0433 \u043f\u0440\u0438\u043d\u0451\u0441 \u043a\u0430\u0436\u0434\u044b\u0439 \u0430\u0432\u0442\u043e \u0432 \u0431\u044e\u0434\u0436\u0435\u0442"},{"location":"report_practical/","title":"\u041f\u0440\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0440\u0430\u0431\u043e\u0442\u0430 3.1","text":""},{"location":"report_practical/#1","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 1:","text":"<p>\u041d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u0437\u0430\u043f\u0440\u043e\u0441 \u043d\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 6-7 \u043d\u043e\u0432\u044b\u0445 \u0430\u0432\u0442\u043e\u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435\u0432 \u0438 5-6 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0435\u0439, \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u0430\u0432\u0442\u043e\u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0443 \u043d\u0430\u0437\u043d\u0430\u0447\u044c\u0442\u0435 \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u0435\u043d\u0438\u0435 \u0438 \u043e\u0442 1 \u0434\u043e 3 \u0430\u0432\u0442\u043e\u043c\u043e\u0431\u0438\u043b\u0435\u0439. \u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u043c\u043e\u0436\u0435\u0442\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043b\u0438\u0431\u043e \u0432 \u0438\u043d\u0442\u0435\u0440\u0430\u043a\u0442\u0438\u0432\u043d\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 \u0438\u043d\u0442\u0435\u0440\u043f\u0440\u0435\u0442\u0430\u0442\u043e\u0440\u0430, \u043b\u0438\u0431\u043e \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e\u043c python-\u0444\u0430\u0439\u043b\u0435. \u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u043c \u0434\u043e\u043b\u0436\u043d\u044b \u0441\u0442\u0430\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432. </p>"},{"location":"report_practical/#_1","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435:","text":"<pre><code>import os\nimport django\nfrom datetime import datetime\n\nos.environ.setdefault('DJANGO_SETTINGS_MODULE', 'simple_django_web_project.settings')\ndjango.setup()\n\nfrom project_first_app.models import Owner, Car, DrivingLicense, Ownership\n\ncars = []\n\ndef add_owners():\n    Owner.objects.all().delete()\n    Owner.objects.create(last_name='Amber', first_name='Mike', birthday=datetime(1999, 12, 11))\n    Owner.objects.create(last_name='Conner', first_name='Bill', birthday=datetime(2001, 11, 6))\n    Owner.objects.create(last_name='Hurley', first_name='Ann', birthday=datetime(1987, 10, 15))\n    Owner.objects.create(last_name='Pierce', first_name='Jeff', birthday=datetime(2000, 10, 27))\n    Owner.objects.create(last_name='Boyer', first_name='Bob', birthday=datetime(1974, 9, 5))\n    Owner.objects.create(last_name='Clayton', first_name='Alex', birthday=datetime(1979, 1, 2))\n\ndef add_cars():\n    Car.objects.all().delete()\n    cars.append(Car.objects.create(license_plate='TZR378', brand='BMW', model=\"520i\", color=\"black\"))\n    cars.append(Car.objects.create(license_plate='24724A', brand='Toyota', model=\"Camry\", color=\"white\"))\n    cars.append(Car.objects.create(license_plate='11420Y', brand='Toyota', model=\"Camry\", color=\"black\"))\n    cars.append(Car.objects.create(license_plate='25394A', brand='Dodge', model=\"Charger\", color=\"red\"))\n    cars.append(Car.objects.create(license_plate='26064A', brand='Chevrolet', model=\"Malibu\", color=\"gray\"))\n    cars.append(Car.objects.create(license_plate='AH32943', brand='Honda', model=\"Accord\", color=\"blue\"))\n\ndef add_driving_licenses():\n    DrivingLicense.objects.all().delete()\n    DrivingLicense.objects.create(owner=Owner.objects.filter(first_name=\"Mike\").first(), number='451549845', type=\"B\", date_of_issue=datetime(2018, 11, 25))\n    DrivingLicense.objects.create(owner=Owner.objects.filter(first_name=\"Bill\").first(), number='545800949', type=\"B\", date_of_issue=datetime(2022, 10, 12))\n    DrivingLicense.objects.create(owner=Owner.objects.filter(first_name=\"Ann\").first(), number='798132657', type=\"B\", date_of_issue=datetime(2012, 11, 23))\n    DrivingLicense.objects.create(owner=Owner.objects.filter(first_name=\"Jeff\").first(), number='19543250', type=\"B\", date_of_issue=datetime(2023, 2, 19))\n    DrivingLicense.objects.create(owner=Owner.objects.filter(first_name=\"Bob\").first(), number='465159457', type=\"B\", date_of_issue=datetime(1999, 1, 26))\n    DrivingLicense.objects.create(owner=Owner.objects.filter(first_name=\"Alex\").first(), number='019798429', type=\"B\", date_of_issue=datetime(2002, 9, 1))\n\n    DrivingLicense.objects.create(owner=Owner.objects.filter(first_name=\"Ann\").first(), number='789914522', type=\"B\", date_of_issue=datetime(2020, 9, 30))\n    DrivingLicense.objects.create(owner=Owner.objects.filter(first_name=\"Bob\").first(), number='4519346878', type=\"B\", date_of_issue=datetime(2006, 2, 25))\n    DrivingLicense.objects.create(owner=Owner.objects.filter(first_name=\"Bob\").first(), number='198732415', type=\"B\", date_of_issue=datetime(2014, 1, 21))\n    DrivingLicense.objects.create(owner=Owner.objects.filter(first_name=\"Bob\").first(), number='678121634', type=\"B\", date_of_issue=datetime(2023, 1, 2))\n    DrivingLicense.objects.create(owner=Owner.objects.filter(first_name=\"Alex\").first(), number='975316515', type=\"B\", date_of_issue=datetime(2010, 9, 15))\n    DrivingLicense.objects.create(owner=Owner.objects.filter(first_name=\"Alex\").first(), number='121578746', type=\"B\", date_of_issue=datetime(2020, 9, 10))\n\ndef add_ownership():\n    Ownership.objects.all().delete()\n    Ownership.objects.create(owner=Owner.objects.filter(first_name=\"Mike\").first(), car=cars[0], start_date=datetime(2015, 6, 8), end_date=None)\n    Ownership.objects.create(owner=Owner.objects.filter(first_name=\"Bill\").first(), car=cars[1], start_date=datetime(2022, 11, 3), end_date=None)\n    Ownership.objects.create(owner=Owner.objects.filter(first_name=\"Ann\").first(), car=cars[0], start_date=datetime(2012, 12, 2), end_date=datetime(2015, 6, 8))\n    Ownership.objects.create(owner=Owner.objects.filter(first_name=\"Ann\").first(), car=cars[2], start_date=datetime(2016, 1, 10), end_date=None)\n    Ownership.objects.create(owner=Owner.objects.filter(first_name=\"Jeff\").first(), car=cars[3], start_date=datetime(2024, 2, 18), end_date=None)\n    Ownership.objects.create(owner=Owner.objects.filter(first_name=\"Bob\").first(), car=cars[2], start_date=datetime(2000, 11, 2), end_date=datetime(2016, 1, 10))\n    Ownership.objects.create(owner=Owner.objects.filter(first_name=\"Bob\").first(), car=cars[3], start_date=datetime(2016, 3, 11), end_date=datetime(2024, 2, 18))\n    Ownership.objects.create(owner=Owner.objects.filter(first_name=\"Bob\").first(), car=cars[4], start_date=datetime(2025, 3, 8), end_date=None)\n    Ownership.objects.create(owner=Owner.objects.filter(first_name=\"Alex\").first(), car=cars[5], start_date=datetime(2005, 8, 6), end_date=None)\n\n#add_owners()\n#add_cars()\n#add_driving_licenses()\n#add_ownership()\n\nfor ownership in Ownership.objects.all():\n    print(f\"{ownership.owner.first_name} {ownership.owner.last_name}, born in {ownership.owner.birthday}, \\\nlast driver license got issued in {DrivingLicense.objects.filter(owner=ownership.owner).latest(\"date_of_issue\").date_of_issue} has driven this car:\")\n    print(f\"    {ownership.car}\")\n</code></pre>"},{"location":"report_practical/#2","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 2:","text":"<p>\u041f\u043e \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u043c \u0432 \u043f\u0440.1 \u0434\u0430\u043d\u043d\u044b\u043c \u043d\u0430\u043f\u0438\u0441\u0430\u0442\u044c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b \u043d\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u0430\u0446\u0438\u044e: \u0413\u0434\u0435 \u044d\u0442\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e, \u0434\u043e\u0431\u0430\u0432\u044c\u0442\u0435 related_name \u043a \u043f\u043e\u043b\u044f\u043c \u043c\u043e\u0434\u0435\u043b\u0438 \u0412\u044b\u0432\u0435\u0434\u0435\u0442\u0435 \u0432\u0441\u0435 \u043c\u0430\u0448\u0438\u043d\u044b \u043c\u0430\u0440\u043a\u0438 \u201cToyota\u201d (\u0438\u043b\u0438 \u043b\u044e\u0431\u043e\u0439 \u0434\u0440\u0443\u0433\u043e\u0439 \u043c\u0430\u0440\u043a\u0438, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0443 \u0432\u0430\u0441 \u0435\u0441\u0442\u044c) \u041d\u0430\u0439\u0442\u0438 \u0432\u0441\u0435\u0445 \u0432\u043e\u0434\u0438\u0442\u0435\u043b\u0435\u0439 \u0441 \u0438\u043c\u0435\u043d\u0435\u043c \u201c\u041e\u043b\u0435\u0433\u201d (\u0438\u043b\u0438 \u043b\u044e\u0431\u044b\u043c \u0434\u0440\u0443\u0433\u0438\u043c \u0438\u043c\u0435\u043d\u0435\u043c \u043d\u0430 \u0432\u0430\u0448\u0435 \u0443\u0441\u043c\u043e\u0442\u0440\u0435\u043d\u0438\u0435) \u0412\u0437\u044f\u0432 \u043b\u044e\u0431\u043e\u0433\u043e \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u043e\u0433\u043e \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0430 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0435\u0433\u043e id, \u0438 \u043f\u043e \u044d\u0442\u043e\u043c\u0443 id \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u0435\u043d\u0438\u044f \u0432 \u0432\u0438\u0434\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u043c\u043e\u0434\u0435\u043b\u0438 (\u043c\u043e\u0436\u043d\u043e \u0432 2 \u0437\u0430\u043f\u0440\u043e\u0441\u0430) \u0412\u044b\u0432\u0435\u0441\u0442\u0438 \u0432\u0441\u0435\u0445 \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435\u0432 \u043a\u0440\u0430\u0441\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d (\u0438\u043b\u0438 \u043b\u044e\u0431\u043e\u0433\u043e \u0434\u0440\u0443\u0433\u043e\u0433\u043e \u0446\u0432\u0435\u0442\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0443 \u0432\u0430\u0441 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442) \u041d\u0430\u0439\u0442\u0438 \u0432\u0441\u0435\u0445 \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435\u0432, \u0447\u0435\u0439 \u0433\u043e\u0434 \u0432\u043b\u0430\u0434\u0435\u043d\u0438\u044f \u043c\u0430\u0448\u0438\u043d\u043e\u0439 \u043d\u0430\u0447\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0441 2010 (\u0438\u043b\u0438 \u043b\u044e\u0431\u043e\u0439 \u0434\u0440\u0443\u0433\u043e\u0439 \u0433\u043e\u0434, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0443 \u0432\u0430\u0441 \u0432 \u0431\u0430\u0437\u0435) </p>"},{"location":"report_practical/#_2","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435:","text":"<pre><code>import os\nimport django\nfrom datetime import datetime\n\nos.environ.setdefault('DJANGO_SETTINGS_MODULE', 'simple_django_web_project.settings')\ndjango.setup()\n\nfrom project_first_app.models import Owner, Car, DrivingLicense, Ownership\n\nfor car in Car.objects.filter(brand=\"Toyota\"):\n    print(car)\n\nprint(\"\\n\")\n\nfor owner in Owner.objects.filter(first_name=\"Bob\"):\n    print(owner)\n\nprint(\"\\n\")\n\nperson = Owner.objects.all()[2]\nprint(DrivingLicense.objects.filter(owner=person).latest(\"date_of_issue\")) # \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0435 \u043f\u0440\u043e\u0434\u043b\u0451\u043d\u043d\u044b\u0435 \u043f\u0440\u0430\u0432\u0430\n\nprint(\"\\n\")\n\nfor owner in Owner.objects.filter(ownership__car__color=\"red\", ownership__end_date=None).distinct():\n    print(owner)\n\nprint(\"\\n\")\n\nfor owner in Owner.objects.filter(ownership__start_date__gte=datetime(2010, 1, 1)).distinct():\n    print(owner)\n</code></pre>"},{"location":"report_practical/#3","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 3:","text":"<p>\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0437\u0430\u043f\u0440\u043e\u0441\u044b c \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435\u043c \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0445 \u043c\u0435\u0442\u043e\u0434\u043e\u0432: \u0412\u044b\u0432\u043e\u0434 \u0434\u0430\u0442\u044b \u0432\u044b\u0434\u0430\u0447\u0438 \u0441\u0430\u043c\u043e\u0433\u043e \u0441\u0442\u0430\u0440\u0448\u0435\u0433\u043e \u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0433\u043e \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u0435\u043d\u0438\u044f \u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0441\u0430\u043c\u0443\u044e \u043f\u043e\u0437\u0434\u043d\u044e\u044e \u0434\u0430\u0442\u0443 \u0432\u043b\u0430\u0434\u0435\u043d\u0438\u044f \u043c\u0430\u0448\u0438\u043d\u043e\u0439, \u0438\u043c\u0435\u044e\u0449\u0443\u044e \u043a\u0430\u043a\u0443\u044e-\u0442\u043e \u0438\u0437 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 \u0432 \u0432\u0430\u0448\u0435\u0439 \u0431\u0430\u0437\u0435 \u0412\u044b\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0430\u0448\u0438\u043d \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u041f\u043e\u0434\u0441\u0447\u0438\u0442\u0430\u0439\u0442\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u0430\u0448\u0438\u043d \u043a\u0430\u0436\u0434\u043e\u0439 \u043c\u0430\u0440\u043a\u0438 \u041e\u0442\u0441\u043e\u0440\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u0432\u0441\u0435\u0445 \u0430\u0432\u0442\u043e\u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435\u0432 \u043f\u043e \u0434\u0430\u0442\u0435 \u0432\u044b\u0434\u0430\u0447\u0438 \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u0435\u043d\u0438\u044f</p>"},{"location":"report_practical/#_3","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435:","text":"<pre><code>import os\nimport django\nfrom datetime import datetime\nfrom django.db.models import Count, Max\n\nos.environ.setdefault('DJANGO_SETTINGS_MODULE', 'simple_django_web_project.settings')\ndjango.setup()\n\nfrom project_first_app.models import Owner, Car, DrivingLicense, Ownership\n\nprint(DrivingLicense.objects.earliest(\"date_of_issue\").date_of_issue)\n\nprint(\"\\n\")\n\nprint(Ownership.objects.latest(\"start_date\").start_date)\n\nprint(\"\\n\")\n\nfor owner in (Owner.objects.annotate(ownership_count=Count('ownership'))):\n    print(f\"{owner} had {owner.ownership_count} cars in total\")\n\nprint(\"\\n\")\n\nfor brand in Car.objects.values(\"brand\").annotate(count=Count('brand')):\n    print(f\"{brand[\"brand\"]} - {brand[\"count\"]}\")\n\nprint(\"\\n\")\n\nfor owner in Owner.objects.annotate(dl_last_date=Max(\"drivinglicense__date_of_issue\")).order_by(\"dl_last_date\"):\n    print(owner, f\"{owner.dl_last_date}\")\n\n</code></pre>"},{"location":"report_practical/#32","title":"\u041f\u0440\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0440\u0430\u0431\u043e\u0442\u0430 3.2","text":""},{"location":"report_practical/#1_1","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 1:","text":"<p>\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0435\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u044b \u0434\u043b\u044f \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0438 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0441\u043a\u0438\u043b\u043e\u0432 \u043c\u0435\u0442\u043e\u0434\u043e\u043c, \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u043c \u0432 \u043f\u0443\u043d\u043a\u0442\u0435 \u0432\u044b\u0448\u0435.</p>"},{"location":"report_practical/#_4","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435:","text":"<pre><code>from rest_framework.views import APIView\nfrom rest_framework.response import Response\nfrom rest_framework import generics\n\nfrom .models import Warrior, Profession, Skill, SkillOfWarrior\nfrom .serializers import (\n    WarriorSerializer,\n    WarriorUpdateSerializer,\n    WarriorCreateSerializer,\n    ProfessionCreateSerializer,\n    SkillSerializer,\n    SkillCreateSerializer,\n    WarriorExtendedSerializer,\n    WarriorProfessionSerializer,\n    WarriorSkillSerializer,\n    SkillOfWarriorCreateSerializer,\n)\n\nclass SkillListAPIView(APIView):\n    def get(self, request):\n        skills = Skill.objects.all()\n        serializer = SkillSerializer(skills, many=True)\n        return Response({\"Skills\": serializer.data})\n\nclass SkillCreateAPIView(APIView):\n    def post(self, request):\n        skill_data = request.data.get(\"skill\")\n        serializer = SkillCreateSerializer(data=skill_data)\n\n        if serializer.is_valid(raise_exception=True):\n            skill_saved = serializer.save()\n\n        return Response({\"Success\": f\"Skill '{skill_saved.title}' created succesfully.\"})\n</code></pre>"},{"location":"report_practical/#2_1","title":"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 2:","text":"<p>\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0435\u043d\u0434\u043f\u043e\u0438\u043d\u0442\u044b: - \u0412\u044b\u0432\u043e\u0434 \u043f\u043e\u043b\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0432\u0441\u0435\u0445 \u0432\u043e\u0439\u043d\u0430\u0445 \u0438 \u0438\u0445 \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u044f\u0445 (\u0432 \u043e\u0434\u043d\u043e\u043c \u0437\u0430\u043f\u0440\u043e\u0441\u0435). - \u0412\u044b\u0432\u043e\u0434 \u043f\u043e\u043b\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0432\u0441\u0435\u0445 \u0432\u043e\u0439\u043d\u0430\u0445 \u0438 \u0438\u0445 \u0441\u043a\u0438\u043b\u0430\u0445 (\u0432 \u043e\u0434\u043d\u043e\u043c \u0437\u0430\u043f\u0440\u043e\u0441\u0435). - \u0412\u044b\u0432\u043e\u0434 \u043f\u043e\u043b\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0432\u043e\u0439\u043d\u0435 (\u043f\u043e id), \u0435\u0433\u043e \u043f\u0440\u043e\u0444\u0435\u0441\u0441\u0438\u044f\u0445 \u0438 \u0441\u043a\u0438\u043b\u0430\u0445. - \u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0432\u043e\u0439\u043d\u0430 \u043f\u043e id. - \u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0432\u043e\u0439\u043d\u0435.</p>"},{"location":"report_practical/#_5","title":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435:","text":"<pre><code>class WarriorProfessionListAPIView(generics.ListAPIView):\n    serializer_class = WarriorProfessionSerializer\n    queryset = Warrior.objects.all()\n\nclass WarriorSkillListAPIView(generics.ListAPIView):\n    serializer_class = WarriorSkillSerializer\n    queryset = Warrior.objects.all()\n\nclass WarriorRetrieveDestroyAPIView(generics.RetrieveDestroyAPIView):\n    serializer_class = WarriorExtendedSerializer\n    queryset = Warrior.objects.all()\n\nclass WarriorRetrieveUpdateAPIView(generics.RetrieveUpdateAPIView):\n    serializer_class = WarriorUpdateSerializer\n    queryset = Warrior.objects.all()\n\nclass WarriorCreateAPIView(generics.CreateAPIView):\n   serializer_class = WarriorCreateSerializer\n   queryset = Warrior.objects.all()\n\n   def perform_create(self, serializer):\n       serializer.save() \n</code></pre>"},{"location":"report_practical/#serializerspy","title":"serializers.py","text":"<pre><code>from rest_framework import serializers\nfrom .models import Warrior, Profession, Skill, SkillOfWarrior\n\nclass WarriorSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = Warrior\n        fields = \"__all__\"\n\nclass WarriorCreateSerializer(serializers.ModelSerializer):\n    def create(self, validated_data):\n        return Warrior.objects.create(**validated_data)\n\n    class Meta:\n        model = Warrior\n        fields = \"__all__\"\n\nclass SkillSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = Skill\n        fields = [\"title\"]\n\nclass SkillCreateSerializer(serializers.Serializer):\n    title = serializers.CharField(max_length=120)\n\n    def create(self, validated_data):\n        return Skill.objects.create(**validated_data)\n\nclass ProfessionSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = Profession\n        fields = [\"title\", \"description\"]\n\nclass ProfessionCreateSerializer(serializers.Serializer):\n    title = serializers.CharField(max_length=120)\n    description = serializers.CharField()\n\n    def create(self, validated_data):\n       profession = Profession(**validated_data)\n       profession.save()\n       return Profession(**validated_data)\n\nclass WarriorSkillSerializer(serializers.ModelSerializer):\n    skill = SkillSerializer(many=True)\n    race = serializers.CharField(source=\"get_race_display\", read_only=True)\n\n    class Meta:\n        model = Warrior\n        fields = \"__all__\"\n\nclass WarriorProfessionSerializer(serializers.ModelSerializer):\n    profession = ProfessionSerializer()\n    race = serializers.CharField(source=\"get_race_display\", read_only=True)\n\n    class Meta:\n        model = Warrior\n        fields = \"__all__\"\n\nclass WarriorExtendedSerializer(serializers.ModelSerializer):\n    profession = ProfessionSerializer()\n    skill = SkillSerializer(many=True)\n    race = serializers.CharField(source=\"get_race_display\", read_only=True)\n\n    class Meta:\n        model = Warrior\n        fields = \"__all__\"\n\nclass WarriorUpdateSerializer(serializers.ModelSerializer):\n    def update(self, instance, validated_data):\n        return super().update(instance, validated_data)\n\n    class Meta:\n        model = Warrior\n        fields = \"__all__\"\n\nclass SkillOfWarriorCreateSerializer(serializers.ModelSerializer):\n    def create(self, validated_data):\n        return SkillOfWarrior.objects.create(**validated_data)\n\n    class Meta:\n        model = SkillOfWarrior\n        fields = \"__all__\"\n</code></pre>"}]}